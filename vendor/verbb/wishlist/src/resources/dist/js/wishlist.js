!function(d){void 0===Craft.Wishlist&&(Craft.Wishlist={});var n="verbb\\wishlist\\elements\\ListElement";Craft.Wishlist.ListIndex=Craft.BaseElementIndex.extend({listTypes:null,$newListBtnGroup:null,$newListBtn:null,canCreateLists:!1,afterInit:function(){this.listTypes=[];for(var t=0;t<this.$sources.length;t++){var i=this.$sources.eq(t),e,s=i.data("key").match(/^listType:(\d+)$/);s&&(this.listTypes.push({id:parseInt(s[1]),handle:i.data("handle"),name:i.text(),editable:i.data("editable")}),!this.canCreateLists&&i.data("editable")&&(this.canCreateLists=!0))}this.on("selectSource",d.proxy(this,"updateButton")),this.base()},getDefaultSourceKey:function(){if("index"===this.settings.context&&"undefined"!=typeof defaultListTypeHandle)for(var t=0;t<this.$sources.length;t++){var i=d(this.$sources[t]);if(i.data("handle")===defaultListTypeHandle)return i.data("key")}return this.base()},updateButton:function(){var t=this.$source.data("handle"),i;if(this.$newListBtnGroup&&this.$newListBtnGroup.remove(),t)for(var e=0;e<this.listTypes.length;e++)if(this.listTypes[e].handle===t){i=this.listTypes[e];break}if(this.canCreateLists){var s;if(this.$newListBtnGroup=d('<div class="btngroup submit"/>'),i){var n=this._getListTypeTriggerHref(i),a="index"===this.settings.context?Craft.t("wishlist","New list"):Craft.t("wishlist","New {listType} list",{listType:i.name});this.$newListBtn=d('<a class="btn submit add icon" '+n+">"+a+"</a>").appendTo(this.$newListBtnGroup),"index"!==this.settings.context&&this.addListener(this.$newListBtn,"click",function(t){this._openCreateListModal(t.currentTarget.getAttribute("data-id"))}),1<this.listTypes.length&&(s=d('<div class="btn submit menubtn"></div>').appendTo(this.$newListBtnGroup))}else this.$newListBtn=s=d('<div class="btn submit add icon menubtn">'+Craft.t("wishlist","New list")+"</div>").appendTo(this.$newListBtnGroup);if(s){for(var r='<div class="menu"><ul>',e=0;e<this.listTypes.length;e++){var l=this.listTypes[e],n,a;if("index"===this.settings.context||l!==i)r+="<li><a "+(n=this._getListTypeTriggerHref(l))+'">'+(a="index"===this.settings.context?l.name:Craft.t("wishlist","New {listType} list",{listType:l.name}))+"</a></li>"}d(r+="</ul></div>").appendTo(this.$newListBtnGroup);var h=new Garnish.MenuBtn(s);"index"!==this.settings.context&&h.on("optionSelect",d.proxy(function(t){this._openCreateListModal(t.option.getAttribute("data-id"))},this))}this.addButton(this.$newListBtnGroup)}if("index"===this.settings.context&&"undefined"!=typeof history){var o="wishlist/lists";t&&(o+="/"+t),history.replaceState({},"",Craft.getUrl(o))}},_getListTypeTriggerHref:function(t){return"index"===this.settings.context?'href="'+Craft.getUrl("wishlist/lists/"+t.handle+"/new")+'"':'data-id="'+t.id+'"'},_openCreateListModal:function(e){if(!this.$newListBtn.hasClass("loading")){for(var t,i=0;i<this.listTypes.length;i++)if(this.listTypes[i].id===e){t=this.listTypes[i];break}if(t){this.$newListBtn.addClass("inactive");var s=this.$newListBtn.text();this.$newListBtn.text(Craft.t("wishlist","New {listType} list",{listType:t.name})),new Craft.ElementEditor({hudTrigger:this.$newListBtnGroup,elementType:n,locale:this.locale,attributes:{typeId:e},onBeginLoading:d.proxy(function(){this.$newListBtn.addClass("loading")},this),onEndLoading:d.proxy(function(){this.$newListBtn.removeClass("loading")},this),onHideHud:d.proxy(function(){this.$newListBtn.removeClass("inactive").text(s)},this),onSaveElement:d.proxy(function(t){var i="listType:"+e;this.sourceKey!==i&&this.selectSourceByKey(i),this.selectElementAfterUpdate(t.id),this.updateElements()},this)})}}}});try{Craft.registerElementIndexClass(n,Craft.Wishlist.ListIndex)}catch(t){}}(jQuery),void 0===Craft.Wishlist&&(Craft.Wishlist={}),jQuery;
//# sourceMappingURL=wishlist.js.map